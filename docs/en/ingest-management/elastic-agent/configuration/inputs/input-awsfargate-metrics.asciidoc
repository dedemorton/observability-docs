:input-type: awsfargate-metrics

[[awsfargate-metrics-input]]
== awsfargate input

beta[]

Use the `awsfargate/metrics` input to collect AWS fargate metrics
from a
https://docs.aws.amazon.com/AmazonECS/latest/userguide/task-metadata-endpoint-v4-fargate.html[task metadata endpoint]. 

//QUESTION: How much detail do we need to include here? I'm not sure how much to
//include in the settings reference (lots of detail about AWS ECS and Fargate).
//In fact, to use this input it sounds like you have to run Metricbeat as a
//sidecar container within the task defn.

Example:

//TODO: convert to correct config syntax for agent. 

[source,yaml]
----
  metricbeat.modules:
  - module: awsfargate
    period: 10s
    metricsets:
      - task_stats
----

The `awsfargate/metrics` input supports the following settings, grouped by category.
Many of these settings have sensible defaults that allow you to run {agent}
with minimal configuration.

<<input-awsfargate-metrics-metricset-settings>>::
Available metricsets and their settings.

<<input-awsfargate-metrics-standard-settings>>::
Standard settings available to any metrics input.

<<input-awsfargate-metrics-standard-http-settings>>::
Standard settings for inputs or metricsets that define the host as an HTTP URL.

//TODO: Add missing agent-related settings.

[[input-awsfargate-metrics-metricset-settings]]
=== Metricsets

Metricsets available to this input. 

[cols="2*<a"]
|===
| Metricset | Description and settings

|
[[task_stats-metricset]]
`task_stats`
| This metricset collects runtime CPU metrics, disk I/O metrics, memory metrics,
network metrics and container metadata from the
`${ECS_CONTAINER_METADATA_URI_V4}/task/stats` and
`${ECS_CONTAINER_METADATA_URI_V4}/task` endpoints.

[[input-awsfargate-metrics-standard-settings]]
=== General settings

General settings available to any metrics input.

[cols="2*<a"]
|===
| Settings | Description

include::input-shared-metrics-settings.asciidoc[tag=enabled-setting]

include::input-shared-metrics-settings.asciidoc[tag=fields-setting]

include::input-shared-metrics-settings.asciidoc[tag=hosts-setting]

//QUESTION: Remove this?
include::input-shared-metrics-settings.asciidoc[tag=index-setting]

include::input-shared-metrics-settings.asciidoc[tag=keep_null-setting]

include::input-shared-metrics-settings.asciidoc[tag=metricsets-setting]

include::input-shared-metrics-settings.asciidoc[tag=period-setting]

include::input-shared-metrics-settings.asciidoc[tag=processors-setting]

include::input-shared-metrics-settings.asciidoc[tag=service.name-setting]

include::input-shared-metrics-settings.asciidoc[tag=tags-setting]

|===

[[input-awsfargate-metrics-standard-http-settings]]
=== HTTP settings

Standard settings for inputs or metricsets that define the host as an HTTP URL.

[NOTE]
====
Metricsets that define the host as an HTTP URL can use the standard
schemes for HTTP (`http://` and `https://`) and the following schemes to connect
to local pipes:

* `http+unix://` to connect to UNIX sockets.
* `http+npipe://` to connect to Windows named pipes.
====

[cols="2*<a"]
|===
| Settings | Description

include::input-shared-metrics-settings.asciidoc[tag=basepath-setting]

include::input-shared-metrics-settings.asciidoc[tag=bearer_token_file-setting]

include::input-shared-metrics-settings.asciidoc[tag=connect_timeout-setting]

include::input-shared-metrics-settings.asciidoc[tag=headers-setting]

include::input-shared-metrics-settings.asciidoc[tag=password-setting]

include::input-shared-metrics-settings.asciidoc[tag=query-setting]

include::input-shared-metrics-settings.asciidoc[tag=ssl-setting]

include::input-shared-metrics-settings.asciidoc[tag=timeout-setting]

include::input-shared-metrics-settings.asciidoc[tag=username-setting]

|===

:input-type!: